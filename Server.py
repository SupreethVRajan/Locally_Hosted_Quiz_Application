questions = [
{"1 + 1 = \n(1) 2 \n(2) 1 \n(3) 3 \n(4) 5 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 2 = \n(1) 3 \n(2) 4 \n(3) 2 \n(4) 6 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 3 = \n(1) 4 \n(2) 3 \n(3) 5 \n(4) 7 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 4 = \n(1) 4 \n(2) 6 \n(3) 5 \n(4) 8 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 5 = \n(1) 7 \n(2) 6 \n(3) 5 \n(4) 9 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 6 = \n(1) 6 \n(2) 8 \n(3) 7 \n(4) 10 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 7 = \n(1) 8 \n(2) 9 \n(3) 7 \n(4) 11 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 8 = \n(1) 8 \n(2) 9 \n(3) 10 \n(4) 12 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 9 = \n(1) 10 \n(2) 11 \n(3) 9 \n(4) 13 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 10 = \n(1) 12 \n(2) 11 \n(3) 10 \n(4) 14 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 11 = \n(1) 13 \n(2) 12 \n(3) 11 \n(4) 15 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 12 = \n(1) 14 \n(2) 12 \n(3) 13 \n(4) 16 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 13 = \n(1) 15 \n(2) 14 \n(3) 13 \n(4) 17 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 14 = \n(1) 15 \n(2) 14 \n(3) 16 \n(4) 18 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 15 = \n(1) 15 \n(2) 17 \n(3) 16 \n(4) 19 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 16 = \n(1) 16 \n(2) 17 \n(3) 18 \n(4) 20 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 17 = \n(1) 18 \n(2) 17 \n(3) 19 \n(4) 21 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 18 = \n(1) 19 \n(2) 18 \n(3) 20 \n(4) 22 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 19 = \n(1) 21 \n(2) 20 \n(3) 19 \n(4) 23 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 20 = \n(1) 21 \n(2) 20 \n(3) 22 \n(4) 24 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 21 = \n(1) 23 \n(2) 21 \n(3) 22 \n(4) 25 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 22 = \n(1) 23 \n(2) 22 \n(3) 24 \n(4) 26 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 23 = \n(1) 23 \n(2) 24 \n(3) 25 \n(4) 27 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 24 = \n(1) 24 \n(2) 25 \n(3) 26 \n(4) 28 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 25 = \n(1) 25 \n(2) 27 \n(3) 26 \n(4) 29 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 26 = \n(1) 26 \n(2) 27 \n(3) 28 \n(4) 30 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 27 = \n(1) 28 \n(2) 29 \n(3) 27 \n(4) 31 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 28 = \n(1) 28 \n(2) 30 \n(3) 29 \n(4) 32 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 29 = \n(1) 30 \n(2) 31 \n(3) 29 \n(4) 33 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 30 = \n(1) 31 \n(2) 32 \n(3) 30 \n(4) 34 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 31 = \n(1) 32 \n(2) 33 \n(3) 31 \n(4) 35 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 32 = \n(1) 33 \n(2) 32 \n(3) 34 \n(4) 36 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 33 = \n(1) 35 \n(2) 33 \n(3) 34 \n(4) 37 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 34 = \n(1) 36 \n(2) 35 \n(3) 34 \n(4) 38 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 35 = \n(1) 37 \n(2) 35 \n(3) 36 \n(4) 39 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 36 = \n(1) 37 \n(2) 36 \n(3) 38 \n(4) 40 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 37 = \n(1) 38 \n(2) 39 \n(3) 37 \n(4) 41 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 38 = \n(1) 38 \n(2) 39 \n(3) 40 \n(4) 42 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 39 = \n(1) 41 \n(2) 40 \n(3) 39 \n(4) 43 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 40 = \n(1) 40 \n(2) 42 \n(3) 41 \n(4) 44 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 41 = \n(1) 42 \n(2) 41 \n(3) 43 \n(4) 45 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 42 = \n(1) 43 \n(2) 42 \n(3) 44 \n(4) 46 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 43 = \n(1) 45 \n(2) 43 \n(3) 44 \n(4) 47 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 44 = \n(1) 46 \n(2) 44 \n(3) 45 \n(4) 48 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 45 = \n(1) 45 \n(2) 46 \n(3) 47 \n(4) 49 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 46 = \n(1) 47 \n(2) 46 \n(3) 48 \n(4) 50 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 47 = \n(1) 47 \n(2) 48 \n(3) 49 \n(4) 51 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 48 = \n(1) 50 \n(2) 49 \n(3) 48 \n(4) 52 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 49 = \n(1) 50 \n(2) 51 \n(3) 49 \n(4) 53 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 50 = \n(1) 52 \n(2) 50 \n(3) 51 \n(4) 54 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 51 = \n(1) 53 \n(2) 51 \n(3) 52 \n(4) 55 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 52 = \n(1) 54 \n(2) 53 \n(3) 52 \n(4) 56 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 53 = \n(1) 55 \n(2) 53 \n(3) 54 \n(4) 57 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 54 = \n(1) 55 \n(2) 56 \n(3) 54 \n(4) 58 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 55 = \n(1) 57 \n(2) 56 \n(3) 55 \n(4) 59 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 56 = \n(1) 56 \n(2) 58 \n(3) 57 \n(4) 60 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 57 = \n(1) 57 \n(2) 59 \n(3) 58 \n(4) 61 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 58 = \n(1) 60 \n(2) 59 \n(3) 58 \n(4) 62 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 59 = \n(1) 61 \n(2) 59 \n(3) 60 \n(4) 63 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 60 = \n(1) 62 \n(2) 61 \n(3) 60 \n(4) 64 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 61 = \n(1) 62 \n(2) 63 \n(3) 61 \n(4) 65 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 62 = \n(1) 62 \n(2) 64 \n(3) 63 \n(4) 66 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 63 = \n(1) 63 \n(2) 65 \n(3) 64 \n(4) 67 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 64 = \n(1) 65 \n(2) 64 \n(3) 66 \n(4) 68 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 65 = \n(1) 66 \n(2) 65 \n(3) 67 \n(4) 69 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 66 = \n(1) 67 \n(2) 68 \n(3) 66 \n(4) 70 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 67 = \n(1) 69 \n(2) 67 \n(3) 68 \n(4) 71 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 68 = \n(1) 70 \n(2) 69 \n(3) 68 \n(4) 72 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 69 = \n(1) 71 \n(2) 70 \n(3) 69 \n(4) 73 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 70 = \n(1) 72 \n(2) 70 \n(3) 71 \n(4) 74 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 71 = \n(1) 73 \n(2) 71 \n(3) 72 \n(4) 75 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 72 = \n(1) 72 \n(2) 74 \n(3) 73 \n(4) 76 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 73 = \n(1) 73 \n(2) 75 \n(3) 74 \n(4) 77 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 74 = \n(1) 75 \n(2) 76 \n(3) 74 \n(4) 78 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 75 = \n(1) 77 \n(2) 76 \n(3) 75 \n(4) 79 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 76 = \n(1) 76 \n(2) 77 \n(3) 78 \n(4) 80 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 77 = \n(1) 77 \n(2) 79 \n(3) 78 \n(4) 81 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 78 = \n(1) 78 \n(2) 80 \n(3) 79 \n(4) 82 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 79 = \n(1) 80 \n(2) 81 \n(3) 79 \n(4) 83 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 80 = \n(1) 82 \n(2) 81 \n(3) 80 \n(4) 84 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 81 = \n(1) 81 \n(2) 83 \n(3) 82 \n(4) 85 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 82 = \n(1) 83 \n(2) 84 \n(3) 82 \n(4) 86 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 83 = \n(1) 83 \n(2) 85 \n(3) 84 \n(4) 87 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 84 = \n(1) 85 \n(2) 86 \n(3) 84 \n(4) 88 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 85 = \n(1) 86 \n(2) 85 \n(3) 87 \n(4) 89 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 86 = \n(1) 87 \n(2) 86 \n(3) 88 \n(4) 90 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 87 = \n(1) 89 \n(2) 88 \n(3) 87 \n(4) 91 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 88 = \n(1) 90 \n(2) 89 \n(3) 88 \n(4) 92 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 89 = \n(1) 91 \n(2) 90 \n(3) 89 \n(4) 93 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 90 = \n(1) 90 \n(2) 92 \n(3) 91 \n(4) 94 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 91 = \n(1) 91 \n(2) 93 \n(3) 92 \n(4) 95 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 92 = \n(1) 93 \n(2) 94 \n(3) 92 \n(4) 96 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 93 = \n(1) 94 \n(2) 95 \n(3) 93 \n(4) 97 \nYOU CAN PRESS THE BUZZER NOW": '1'}, 
{"1 + 94 = \n(1) 96 \n(2) 95 \n(3) 94 \n(4) 98 \nYOU CAN PRESS THE BUZZER NOW": '2'}, 
{"1 + 95 = \n(1) 97 \n(2) 95 \n(3) 96 \n(4) 99 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 96 = \n(1) 98 \n(2) 96 \n(3) 97 \n(4) 100 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 97 = \n(1) 97 \n(2) 99 \n(3) 98 \n(4) 101 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 98 = \n(1) 98 \n(2) 100 \n(3) 99 \n(4) 102 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 99 = \n(1) 99 \n(2) 101 \n(3) 100 \n(4) 103 \nYOU CAN PRESS THE BUZZER NOW": '3'}, 
{"1 + 100 = \n(1) 101 \n(2) 102 \n(3) 100 \n(4) 104 \nYOU CAN PRESS THE BUZZER NOW": '1'}
]


import socket
import time
import select
import random
import queue

PORT = 1590

snames = {}
sockets = []
saddresses = {}
writerslist = []
smarks = {}
messagequeue = {}


# SERVER SETUP
server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
server.bind((socket.gethostname(), PORT))
snames[server] = "server"
sockets.append(server)
saddresses[server] = (socket.gethostname(), PORT) 
server.listen(6)

# MANAGING READING
def managereading():
    readlist, writelist, xlist = select.select(sockets, writerslist, sockets, 10.5)

    if len(readlist) == 0:
        return (None, "timeout")

    for sock in readlist:
        data = sock.recv(1024)
        if data:
            for x in readlist:
                readlist.remove(x)
            return (sock, data.decode('utf-8'))

        else:
            print("Server >> " + f"client {saddresses[sock]} has disconnected.")
            if sock in writerslist:
                writerslist.remove(sock)
            del saddresses[sock]
            del snames[sock]
            sockets.remove(sock)
            sock.close()
            del messagequeue[sock]
    
    for sock in xlist:
        print("Server >> " + f"{saddresses[sock]} is corrupted.")
        del snames[sock]
        del saddresses[sock]
        sockets.remove(sock)
        if sock in writerslist:
            writerslist.remove(sock)
        del messagequeue[sock]
        sock.close()


# MANAGE WRITING
def managewriting():
    readlist, writelist, xlist = select.select(sockets, writerslist, sockets)

    for sock in writelist:
        while(not messagequeue[sock].empty()):
            msg = messagequeue[sock].get()
            if msg.decode('utf-8') == "timeout" :
                print(f"len(writelist) == {len(writelist)}")
                print(f"len(writerslist) == {len(writerslist)}")
                print(f"sending timeout message to {snames[sock]}")
            sock.send(msg)
        writerslist.remove(sock)

    
    for sock in xlist:
        print("Server >> " + f"{saddresses[sock]} is corrupted.")
        del snames[sock]
        del saddresses[sock]
        sockets.remove(sock)
        if sock in writerslist:
            writerslist.remove(sock)
        del messagequeue[sock]
        sock.close()

    if (len(sockets) == 1):
        print("Server >> " + "All connections closed. Exiting...")
        exit(0)


# CLIENT SETUP
while True:
    client, address = server.accept()
    msg = f"Connection from {address} accepted."
    print("Server >> " + msg)
    msg += "\nPlease enter the participant name:"
    sockets.append(client)
    saddresses[client] = address
    smarks[client] = 0
    messagequeue[client] = queue.Queue()
    client.send(bytes(msg, 'utf-8'))
    name = client.recv(1024).decode('utf-8')
    snames[client] = name
    if len(sockets) == 4:
        break

print("Server >> " + "All connections accepted.")
msg = "All participants connected.\nLet's start the game!!!"
for sock in sockets:
    if sock is not server:
        writerslist.append(sock)
        messagequeue[sock].put(bytes(msg, 'utf-8'))
managewriting()


# MANAGE QUIZ
def managequiz():

    questemp = questions.copy()
    status = "good"
    winner = None

    # TIMING ACTIVATION
    timemessage = f"15s for quiz to start."
    for sock in sockets:
        if sock is not server:
            writerslist.append(sock)
            messagequeue[sock].put(bytes(timemessage, 'utf-8'))
    managewriting()
    time.sleep(5)
    timemessage = f"10s for quiz to start."
    for sock in sockets:
        if sock is not server:
            writerslist.append(sock)
            messagequeue[sock].put(bytes(timemessage, 'utf-8'))
    managewriting()
    time.sleep(5)

    while(not winner and status == "good"):

        timemessage = f"5s for question."
        for sock in sockets:
            if sock is not server:
                writerslist.append(sock)
                messagequeue[sock].put(bytes(timemessage, 'utf-8'))
        managewriting()
        time.sleep(5)

        # QUESTION DISPLAY
        if len(questemp) > 1:
            qno = random.randrange(0, len(questemp) - 1)
        else:
            qno = 0
        print("Server >> " + f"Sending question #{qno} to all clients.")
        q = [x for x in questemp[qno].keys()][0]
        A = questemp[qno][q]
        for sock in sockets:
            if sock is not server:
                writerslist.append(sock)
                messagequeue[sock].put(bytes(q, 'utf-8'))
        managewriting()

        # BUZZER
        print("Server >> " + "Listening for buzzer from all clients.")
        intime = time.time()
        tu = managereading()
        time.sleep(0.1)

        # ANSWER
        if tu[1] != "timeout":

            # ACKNOWLEDGEMENT
            print("Server >> " + "Sending acknowledgement to all clients.")
            buzzermessage = f"{snames[tu[0]]} has pressed the buzzer first."
            for sock in sockets:
                if sock is not server and sock is not tu[0]:
                    writerslist.append(sock)
                    messagequeue[sock].put(bytes(buzzermessage, 'utf-8'))
            # ANSWER MESSAGE
            print("Server >> " + f"{snames[tu[0]]} has pressed the buzzer.")
            answermessage = "buzz"
            writerslist.append(tu[0])
            messagequeue[tu[0]].put(bytes(answermessage, 'utf-8'))
            managewriting()

            # ANSWER
            print("Server >> " + f"Reading answer from {snames[tu[0]]}.")
            ans = tu[0].recv(10)

            # CHECKING
            time.sleep(0.1)
            if int(ans) == int(A):
                smarks[tu[0]] += 1
                print("Server >> " + "Correct answer.\nServer >> Sending result to all clients.")
                correctmessage = f"{snames[tu[0]]} has answered correctly."
                for sock in sockets:
                    if sock is not server:
                        writerslist.append(sock)
                        messagequeue[sock].put(bytes(correctmessage, 'utf-8'))
                managewriting()
            else :
                smarks[tu[0]] -= 0.5
                print("Server >> " + "Wrong answer.\nServer >> Sending result to all clients.")
                wrongmessage = f"{snames[tu[0]]} has answered incorrectly."
                for sock in sockets:
                    if sock is not server:
                        writerslist.append(sock)
                        messagequeue[sock].put(bytes(wrongmessage, 'utf-8'))
                managewriting()

        else:
            print("Server >> " + "Timeout occurred.\nServer >> Sending timeout acknowledgement to all clients.")
            timeoutmessage = "timeout"
            for sock in sockets:
                if sock is not server:
                    writerslist.append(sock)
                    messagequeue[sock].put(bytes(timeoutmessage, 'utf-8'))
            print(f"len(writerslist) == {len(writerslist)}")
            managewriting()
        time.sleep(0.1)

        questemp.pop(qno)


        # CHECKING FOR WINNERS AND LOSERS
        lo = 0
        for x in smarks.values():
            if x >= 5:
                winner = tu[0]
            if x <= -3:
                lo += 1
        if lo == len(smarks.values()):
            status = "bad"


        #SCORES
        print("Server >> " + "Sending the scores to all clients.")
        for sock in sockets:
            if sock is not server:
                msg = f"your score is {smarks[sock]}."
                writerslist.append(sock)
                messagequeue[sock].put(bytes(msg, 'utf-8'))
        managewriting()
        time.sleep(1)

        if time.time() < intime + 15:
            time.sleep(15 - time.time() + intime)


        # CONTINUE
        if not winner and status == "good":
            print("Server >> " + "Sending continue message to clients.")
            for sock in sockets:
                if sock is not server:
                    msg = "yes"
                    writerslist.append(sock)
                    messagequeue[sock].put(bytes(msg, 'utf-8'))
            managewriting()
            time.sleep(0.1)

    # STOP
    print("Server >> " + "Sending stop message to clients.")
    for sock in sockets:
        if sock is not server:
            msg = "stop"
            writerslist.append(sock)
            messagequeue[sock].put(bytes(msg, 'utf-8'))
    managewriting()
    time.sleep(0.1)


    # WIN/LOSE
    print("Server >> " + f"{snames[winner]} is the winner.\nServer >> Sending winner message to all clients.")
    if status == "good" :
        print("Server >> " + f"{snames[winner]} is the winner.\nServer >> Sending winner message to all clients.")
        winnermessage = f"{snames[winner]} is the winner"
        for sock in sockets:
            if sock is not server:
                writerslist.append(sock)
                messagequeue[sock].put(bytes(winnermessage, 'utf-8'))
        managewriting()

    else:
        losermessage = f"NOBODY WON"
        print("Server >> " + f"Nobody is the winner.\nServer >> Sending loser message to all clients.")
        for sock in sockets:
            if sock is not server:
                writerslist.append(sock)
                messagequeue[sock].put(bytes(losermessage, 'utf-8'))
        managewriting()

managequiz()

for s in sockets:
    if s is not server:
        s.close()

exit()